

'-- TITLE SCREEN --

SUB TITLE_SCREEN

 PAGE WRITE 0

 IF MUSIC_BKG=2 THEN
  PLAY STOP
  PLAY MODFILE "./MUSICS/WOLF_3D.MOD",22050
 ENDIF

 FADE_IN_12("INTRO")

 'LOOP IF KEEP A KEY PRESSED
 K=1
 DO WHILE K<>0
  K=KEYDOWN(1)
 LOOP

 'WAIT FOR SPACE OR ESC
 GO=0 
 DO WHILE GO=0
  K=KEYDOWN(1)
  IF K=10 OR K=32 OR K=27 THEN GO=1
 LOOP

 FADE_OUT_12
 SCR_TYPE$="OPTIONS"

END SUB



'-- LOAD CONTROLS SCREEN --

SUB CONTROLS_SCREEN

 FADE_IN_12("CONTROL")

 'LOOP IF KEEP A KEY PRESSED
 K=1
 DO WHILE K<>0
  K=KEYDOWN(1)
 LOOP

 'WAIT FOR SPACE OR ESC
 GO=0 
 DO WHILE GO=0
  K=KEYDOWN(1)
  IF K=32 OR K=27 THEN GO=1
 LOOP

 FADE_OUT_12
 SCR_TYPE$="OPTIONS"

END SUB



'-- LOAD HIGHSCORES SCREEN AND SHOW TABLE --

SUB HIGHSCORES_SCREEN

 FADE_IN_12("HIGHSCORES")

 'LOOP IF KEEP A KEY PRESSED
 K=1
 DO WHILE K<>0
  K=KEYDOWN(1)
 LOOP

 'WAIT FOR SPACE OR ESC
 GO=0 
 DO WHILE GO=0
  K=KEYDOWN(1)
  IF K=32 OR K=27 THEN GO=1
 LOOP

 FADE_OUT_12
 SCR_TYPE$="OPTIONS"

END SUB


'-- CREDITS SCREEN --
SUB CREDITS_SCREEN

 FADE_IN_12("CREDITS")

 'LOOP IF KEEP A KEY PRESSED
 K=1
 DO WHILE K<>0
  K=KEYDOWN(1)
 LOOP

 'WAIT FOR SPACE OR ESC
 GO=0 
 DO WHILE GO=0
  K=KEYDOWN(1)
  IF K=32 OR K=27 THEN GO=1
 LOOP

 FADE_OUT_12
 SCR_TYPE$="OPTIONS"

END SUB


'-- OPTIONS SCREEN --

SUB OPTIONS_SCREEN

 IF ON_OPTIONS=1 THEN
  IF MUSIC_BKG=2 THEN
   PLAY STOP
   PLAY MODFILE "./MUSICS/WOLF_3D.MOD",22050
  ENDIF
 ENDIF

 OPTC(0)=2
 OPTC(1)=1
 OPTC(2)=1
 OPTC(3)=0
 OPTC(4)=0
 OPTC(5)=1
 OPTC(6)=1
 OPTC(7)=1
 OPTC(8)=1

 'SET OPTIONS
 PAGE WRITE 1
 BOX 0,0,MM.HRES,MM.VRES,0,,RGB(0,0,0,15)

 PAGE WRITE 0
 OPTION_COLORS(0)

 'LOAD THE IMAGE TO GET SPRITES
 IF ON_OPTIONS=0 THEN
  LOAD PNG "./IMAGES/OPTIONS.PNG",,,15
 ELSE
  LOAD PNG "./IMAGES/OPTIONS_BACK.PNG",,,15
 ENDIF

 'GET PISTOL SPRITE 
 BLIT READ #1,1,173,19,11
 BLIT READ #2,1,187,19,11

 'REMOVE PISTOL SPRITES ON PAGE
 BOX 0,172,21,28,0,,RGB(138,0,0)

 FADE_IN_12("")

 PAGE WRITE 1

 'LOAD THE OPTION SCREEN - NEW GAME OR BACK TO THE GAME?
 IF ON_OPTIONS=0 THEN
  LOAD PNG "./IMAGES/OPTIONS.PNG",,,15
 ELSE
  LOAD PNG "./IMAGES/OPTIONS_BACK.PNG",,,15
 ENDIF

 'REMOVE PISTOL SPRITES ON PAGE (AGAIN)
 BOX 0,172,21,28,0,,RGB(138,0,0)

 PAGE WRITE 0
 OPTION_COLORS(0)

 SPR=1: Y=59: OPT=0: K=1
 DO WHILE OPT <= 10 

  'PAINT AREA BUFFER WITH OPTIONS
  PAGE WRITE 0
  OPTION_COLORS(OPT)

  PAGE WRITE 1

  IF KEYLOCK=0 THEN
   FOR T=1 TO 4
    IF K>0 THEN CONTINUE FOR
    K=KEYDOWN(T) 
   NEXT T
  ENDIF

  IF K=129 OR K=128 THEN
   'ERASE SPRITE
   BOX 75,Y+OPT*13,19,11,0,,RGB(89,0,0)
  ENDIF

  SELECT CASE K

   'DOWN
   CASE 129:
    OPT=OPT+1
    PLAY_SFX("ADLIB_MOVE_OPTIONS")
    TIMER=0: IF SPR=1 THEN SPR=2 ELSE SPR=1
    SELECT CASE OPT
     CASE >8: OPT=0
    'OPTIONS NOT AVAILABLE YET
     CASE  3: OPT=5 
    END SELECT

   'UP
   CASE 128:
    OPT=OPT-1
    PLAY_SFX("ADLIB_MOVE_OPTIONS")
    TIMER=0: IF SPR=1 THEN SPR=2 ELSE SPR=1
    SELECT CASE OPT
     CASE <0: OPT=8
     'OPTIONS NOT AVAILABLE YET
     CASE  4: OPT=2
    END SELECT

   'BACK TO TITLE
   CASE 27:
    IF ON_OPTIONS=0 THEN
     PLAY_SFX("ADLIB_BACK_OPTIONS")
     K=0: OPT=100: SCR_TYPE$="TITLE"
     FADE_OUT_12
    ENDIF

   'SELECTED
   CASE 10,32:
    PLAY_SFX("ADLIB_SELECTED")
    K=0
    PAGE WRITE 0
    IF ON_OPTIONS=0 THEN
     LOAD PNG "./IMAGES/OPTIONS.PNG",,,15
    ELSE
     LOAD PNG "./IMAGES/OPTIONS_BACK.PNG",,,15
    ENDIF
    'REMOVE PISTOL SPRITES ON PAGE (AGAIN)
    BOX 0,172,21,28,0,,RGB(138,0,0)
    FADE_OUT_12

    SELECT CASE OPT

     CASE 0:                  'CHOOSE AN EPISODE SCREEN / BACK TO THE GAME
      OPT=102
      IF ON_OPTIONS=0 THEN
       SCR_TYPE$="EPISODES"
      ELSE
       FADE_OUT_12
       SCR_TYPE$="": ACT=0
      ENDIF

     CASE 1:                  'SOUND OPTIONS
      OPT=103: SCR_TYPE$="SOUND_OPTIONS" 

     CASE 2:
      K=0: OPT=100            'SHOW GAME CONTROLS
      FADE_OUT_12: SCR_TYPE$="CONTROLS"

     CASE 5:                  'SCREEN DETAILS
      OPT=103: SCR_TYPE$="GRAPHIC_OPTIONS" 

     CASE 6,7:                'CREDITS / HIGHSCORE SCREEN
      IF OPT=6 THEN SCR_TYPE$="CREDITS" ELSE SCR_TYPE$="HIGHSCORES"
      OPT=103

     CASE 8:
      FADE_OUT_12: END        'QUIT GAME
     
    END SELECT

  END SELECT

  'CHANGE SPRITE
  SEC=TIMER\200
  IF SEC>1 THEN
   TIMER=0: IF SPR=1 THEN SPR=2 ELSE SPR=1
  ENDIF
  IF OPT>=0 AND OPT<=8 THEN BLIT WRITE #SPR,75,Y+OPT*13

  'LOCK KEYBOARD
  KEYLOCK=0: K=0
  FOR T=1 TO 4
   IF KEYDOWN(T)>0 THEN KEYLOCK=1
  NEXT T

 LOOP

END SUB



'-- HOW TOUGH ARE YOU? SCREEN --

SUB HOW_TOUGH_SCREEN

 OPTC(0)=2
 OPTC(1)=1
 OPTC(2)=1
 OPTC(3)=1

 'RESET DIFFICULT OPTIONS
 PAGE WRITE 0
 HOW_TOUGH_COLORS(0)

 LOAD PNG "./IMAGES/HOW_TOUGH_ARE_YOU.PNG",,,15

 FADE_IN_12("")

 PAGE WRITE 1

 LOAD PNG "./IMAGES/HOW_TOUGH_ARE_YOU.PNG",,,15

 PAGE WRITE 0
 HOW_TOUGH_COLORS(0)

 SPR=1: Y=80: OPT=0: K=1
 DO WHILE OPT <= 10 

  'PAINT AREA BUFFER WITH OPTIONS
  PAGE WRITE 0
  HOW_TOUGH_COLORS(OPT)

  PAGE WRITE 1

  IF KEYLOCK=0 THEN
   FOR T=1 TO 4
    IF K>0 THEN CONTINUE FOR
    K=KEYDOWN(T) 
   NEXT T
  ENDIF

  IF K=129 OR K=128 THEN
   'ERASE SPRITE
   BOX 52,Y+OPT*13,19,11,0,,RGB(89,0,0)
  ENDIF

  SELECT CASE K

   'DOWN
   CASE 129:
    OPT=OPT+1
    PLAY_SFX("ADLIB_MOVE_OPTIONS")
    TIMER=0: IF SPR=1 THEN SPR=2 ELSE SPR=1
    SELECT CASE OPT
     CASE >3: OPT=0
    END SELECT

   'UP
   CASE 128:
    OPT=OPT-1
    PLAY_SFX("ADLIB_MOVE_OPTIONS")
    TIMER=0: IF SPR=1 THEN SPR=2 ELSE SPR=1
    SELECT CASE OPT
     CASE <0: OPT=3
    END SELECT

   'BACK TO EPISODES
   CASE 27:
    PLAY_SFX("ADLIB_BACK_OPTIONS")
    FADE_OUT_12
    K=0: OPT=100: SCR_TYPE$="EPISODES"

   'SELECTED
   CASE 10,32:
    PLAY_SFX("ADLIB_SELECTED")
    FADE_OUT_12
    TOUGH=OPT+1: ON_OPTIONS=0
    OPT=101: ACT=0 'ENTER THE GAME
  END SELECT

  'CHANGE SPRITE
  SEC=TIMER\200
  IF SEC>1 THEN
   TIMER=0: IF SPR=1 THEN SPR=2 ELSE SPR=1     
  ENDIF
  IF OPT>=0 AND OPT<=10 THEN BLIT WRITE #SPR,52,Y+OPT*13

  'BJ HEAD
  BLIT 69+OPT*23,62,238,81,23,31,13,0

  'LOCK KEYBOARD
  KEYLOCK=0: K=0
  FOR T=1 TO 4
   IF KEYDOWN(T)>0 THEN KEYLOCK=1
  NEXT T

 LOOP

END SUB



'-- EPISODES SCREEN --

SUB EPISODES_SCREEN

 OPTC(0)=2
 OPTC(1)=0
 OPTC(2)=0
 OPTC(3)=0
 OPTC(4)=0
 OPTC(5)=0

 PAGE WRITE 0
 LOAD PNG "./IMAGES/EPISODES.PNG",,,15

 FADE_IN_12("EPISODES")

 PAGE WRITE 1
 LOAD PNG "./IMAGES/EPISODES.PNG",,,15

 PAGE WRITE 0
 EPISODE_COLORS(0)

 Y=23: OPT=0: K=1
 DO WHILE OPT <= 10 

  'PAINT AREA BUFFER WITH OPTIONS
  PAGE WRITE 0
  EPISODE_COLORS(OPT)
 
  PAGE WRITE 1

  IF KEYLOCK=0 THEN
   FOR T=1 TO 4
    IF K>0 THEN CONTINUE FOR
    K=KEYDOWN(T) 
   NEXT T
  ENDIF

  IF K=129 OR K=128 THEN
   'ERASE BOX
   BOX 40,Y+OPT*26,48,24,1,RGB(0,0,0)
   'ERASE SPRITE
   BOX 15,Y+OPT*26+5,19,11,0,,RGB(89,0,0)
  ENDIF

  SELECT CASE K

   CASE 129:
    OPT=OPT+1
    TIMER=0: IF SPR=1 THEN SPR=2 ELSE SPR=1
    PLAY_SFX("ADLIB_MOVE_OPTIONS")
    IF OPT>5 THEN OPT=0

   CASE 128:
    OPT=OPT-1
    TIMER=0: IF SPR=1 THEN SPR=2 ELSE SPR=1
    PLAY_SFX("ADLIB_MOVE_OPTIONS")
    IF OPT<0 THEN OPT=5

   CASE 27:
    PLAY_SFX("ADLIB_BACK_OPTIONS")
    TIMER=0: IF SPR=1 THEN SPR=2 ELSE SPR=1
    K=0: OPT=100
    FADE_OUT_12: FADE_OUT_12: SCR_TYPE$="OPTIONS"
 
   CASE 10,32:
    IF OPT=0 THEN 'ONLY FIRST EPISODE (FOR A WHILE)
     PLAY_SFX("ADLIB_SELECTED")
     TIMER=0: IF SPR=1 THEN SPR=2 ELSE SPR=1
     K=0: OPT=100
     FADE_OUT_12: FADE_OUT_12: SCR_TYPE$="HOW_TOUGH"
    ENDIF

  END SELECT

  'CHANGE SPRITE
  SEC=TIMER\200
  IF SEC>1 THEN
   TIMER=0: IF SPR=1 THEN SPR=2 ELSE SPR=1     
  ENDIF

  IF OPT>=0 AND OPT<=5 THEN BLIT WRITE #SPR,15,Y+OPT*26+5

  'SELECTION BOX
  BOX 40,Y+OPT*26,48,24,1,RGB(255,255,255)

  'LOCK KEYBOARD
  KEYLOCK=0: K=0
  FOR T=1 TO 4
   IF KEYDOWN(T)>0 THEN KEYLOCK=1
  NEXT T

 LOOP

END SUB


'-- GRAPHIC OPTIONS (SCREEN DETAILS) --

SUB GRAPHIC_OPTIONS_SCREEN

 FOR T=0 TO 5
  OPTC(T)=1
 NEXT T
 OPTC(0)=2
 OPT=0

 PAGE WRITE 0
 GRAPHIC_OPTIONS_COLORS(OPT)

 LOAD PNG "./IMAGES/GRAPHIC_OPTIONS.PNG",,,15
 BLIT READ #3,63,85,12,2

 FOR T=0 TO 5
  BOX 63,85+17*T,12,2,0,,II
 NEXT T

 FADE_IN_12("")

 PAGE WRITE 1

 LOAD PNG "./IMAGES/GRAPHIC_OPTIONS.PNG",,,15
 FOR T=0 TO 5
  BOX 63,85+17*T,12,2,0,,II
 NEXT T

 PAGE WRITE 0
 GRAPHIC_OPTIONS_COLORS(OPT)

 SPR=1: Y=77: OPT=0: K=1
 DO WHILE OPT <= 5

  'PAINT AREA BUFFER WITH OPTIONS
  PAGE WRITE 0
  GRAPHIC_OPTIONS_COLORS(OPT)

  PAGE WRITE 1

  IF KEYLOCK=0 THEN
   FOR T=1 TO 4
    IF K>0 THEN CONTINUE FOR
    K=KEYDOWN(T) 
   NEXT T
  ENDIF

  'SET DETAIL LEVEL
  SELECT CASE OPT
   CASE 0: TDETAIL=-1
   CASE 1: TDETAIL= 2
   CASE 2: TDETAIL= 4
   CASE 3: TDETAIL= 6
   CASE 4: TDETAIL= 8
   CASE 5: TDETAIL=10
  END SELECT

  IF K=129 OR K=128 THEN
   'ERASE SPRITE
   BOX 38,Y+OPT*17+3,19,11,0,,RGB(89,0,0)
  ENDIF

  SELECT CASE K

   'DOWN
   CASE 129:
    OPT=OPT+1
    PLAY_SFX("ADLIB_MOVE_OPTIONS")
    TIMER=0: IF SPR=1 THEN SPR=2 ELSE SPR=1
    IF OPT>5 THEN OPT=0

   'UP
   CASE 128:
    OPT=OPT-1
    PLAY_SFX("ADLIB_MOVE_OPTIONS")
    TIMER=0: IF SPR=1 THEN SPR=2 ELSE SPR=1
    IF OPT<0 THEN OPT=5

   'BACK TO OPTIONS
   CASE 27:
    PLAY_SFX("ADLIB_BACK_OPTIONS")
    FADE_OUT_12
    K=0: OPT=100: SCR_TYPE$="OPTIONS"

   'SELECTED
   CASE 10,32:
    PLAY_SFX("ADLIB_SELECTED")
    DETAIL=TDETAIL
    SELECT CASE DETAIL
     CASE -1: TOPT=0
     CASE  2: TOPT=1
     CASE  4: TOPT=2
     CASE  6: TOPT=3
     CASE  8: TOPT=4
     CASE 10: TOPT=5
    END SELECT

  END SELECT

  'CHANGE SPRITE
  SEC=TIMER\200
  IF SEC>1 THEN
   TIMER=0: IF SPR=1 THEN SPR=2 ELSE SPR=1     
  ENDIF

  'LOCK KEYBOARD
  KEYLOCK=0: K=0
  FOR T=1 TO 4
   IF KEYDOWN(T)>0 THEN KEYLOCK=1
  NEXT T
  IF OPT>=0 AND OPT<=10 THEN 
   FOR T=0 TO 5
    IF T=TOPT THEN BLIT WRITE #3,63,85+T*17 ELSE BOX 63,85+T*17,12,2,0,,RGB(0,0,0)
   NEXT T
   BLIT WRITE #SPR,38,Y+OPT*17+3
  ENDIF

 LOOP

END SUB


'-- SOUND OPTIONS --

SUB SOUND_OPTIONS_SCREEN

 FOR T=0 TO 5
  OPTC(T)=1
 NEXT T
 OPTC(0)=2
 OPT=0

 PAGE WRITE 0
 SOUND_OPTIONS_COLORS(OPT)

 LOAD PNG "./IMAGES/SOUND_OPTIONS.PNG",,,15
 BLIT READ #3,71,78,12,2

 FOR T=0 TO 2
  BOX 71,78+14*T,12,2,0,,II
 NEXT T
 FOR T=3 TO 5
  BOX 71,146+14*(T-3),12,2,0,,II
 NEXT T

 FADE_IN_12("")

 PAGE WRITE 1

 LOAD PNG "./IMAGES/SOUND_OPTIONS.PNG",,,15

 FOR T=0 TO 2
  BOX 71,78+14*T,12,2,0,,II
 NEXT T
 FOR T=3 TO 5
  BOX 71,146+14*(T-3),12,2,0,,II
 NEXT T

 'SET SOUND EFFECTS
 SELECT CASE SFX_SND
  CASE 0: TSFX=0
  CASE 1: TSFX=1
  CASE 2: TSFX=2
 END SELECT

 'SET MUSIC
 SELECT CASE MUSIC_BKG
  CASE 0: TMUS=0
  CASE 1: TMUS=1
  CASE 2: TMUS=2
 END SELECT

 PAGE WRITE 0
 SOUND_OPTIONS_COLORS(OPT)

 SPR=1: Y=73: OPT=0: K=1
 DO WHILE OPT <= 5

  'PAINT AREA BUFFER WITH OPTIONS
  PAGE WRITE 0
  SOUND_OPTIONS_COLORS(OPT)

  PAGE WRITE 1

  IF KEYLOCK=0 THEN
   FOR T=1 TO 4
    IF K>0 THEN CONTINUE FOR
    K=KEYDOWN(T) 
   NEXT T
  ENDIF

  IF K=129 OR K=128 THEN
   'ERASE SPRITE
   IF OPT<3 THEN
    BOX 43,Y+OPT*14+2,19,11,0,,RGB(89,0,0)
   ELSE
    BOX 43,Y+(OPT-3)*14+70,19,11,0,,RGB(89,0,0)
   ENDIF
  ENDIF

  SELECT CASE K

   'DOWN
   CASE 129:
    OPT=OPT+1
    PLAY_SFX("ADLIB_MOVE_OPTIONS")
    TIMER=0: IF SPR=1 THEN SPR=2 ELSE SPR=1
    IF OPT>5 THEN OPT=0

   'UP
   CASE 128:
    OPT=OPT-1
    PLAY_SFX("ADLIB_MOVE_OPTIONS")
    TIMER=0: IF SPR=1 THEN SPR=2 ELSE SPR=1
    IF OPT<0 THEN OPT=5

   'BACK TO OPTIONS
   CASE 27:
    PLAY_SFX("ADLIB_BACK_OPTIONS")
    FADE_OUT_12
    K=0: OPT=100: SCR_TYPE$="OPTIONS"

   'SELECTED
   CASE 10,32:
    PLAY_SFX("ADLIB_SELECTED")
    IF OPT<3 THEN TSFX=OPT ELSE TMUS=OPT-3

    IF TMUS<>MUSIC_BKG THEN
     PLAY STOP
     IF TMUS=2 THEN PLAY MODFILE "./MUSICS/WOLF_3D.MOD",22050
    ENDIF

    SFX_SND=TSFX: MUSIC_BKG=TMUS
   
    'SET SOUND EFFECTS
    SELECT CASE SFX_SND
     CASE 0: TSFX=0
     CASE 1: TSFX=1
     CASE 2: TSFX=2
    END SELECT

    'SET MUSIC
    SELECT CASE MUSIC_BKG
     CASE 0: TMUS=0
     CASE 1: TMUS=1
     CASE 2: TMUS=2
    END SELECT

  END SELECT

  'CHANGE SPRITE
  SEC=TIMER\200
  IF SEC>1 THEN
   TIMER=0: IF SPR=1 THEN SPR=2 ELSE SPR=1     
  ENDIF

  'LOCK KEYBOARD
  KEYLOCK=0: K=0
  FOR T=1 TO 4
   IF KEYDOWN(T)>0 THEN KEYLOCK=1
  NEXT T
  IF OPT>=0 AND OPT<=5 THEN 
   FOR T=0 TO 2
    IF T=TSFX THEN BLIT WRITE #3,71,78+T*14 ELSE BOX 71,78+T*14,12,2,0,,RGB(0,0,0)
   NEXT T
   FOR T=0 TO 2
    IF T=TMUS THEN BLIT WRITE #3,71,146+T*14 ELSE BOX 71,146+T*14,12,2,0,,RGB(0,0,0)
   NEXT T
   IF OPT<3 THEN
    BLIT WRITE #SPR,43,Y+OPT*14+2
   ELSE
    BLIT WRITE #SPR,43,Y+(OPT-3)*14+70
   ENDIF
  ENDIF

 LOOP

END SUB



'-- SHOW DISPONIBLE OPTIONS AND CHANGE COLOR OF THE SELECTED ONE --
SUB SOUND_OPTIONS_COLORS(OPT)

 FOR T=0 TO 5
  IF OPTC(T)>0 THEN
   IF T=OPT THEN OPTC(T)=2 ELSE OPTC(T)=1
  ENDIF
  SELECT CASE OPTC(T)
   CASE 2: I=RGB(255,255,255): II=RGB(255,255,0)
   CASE 1: I=RGB(127,127,127): II=RGB(0,0,0)
   CASE 0: I=RGB(127,0,0): II=RGB(0,0,0)
  END SELECT
  'MARK FONTS
  IF T<3 THEN
   BOX 91,72+14*T,MM.HRES,14,0,,I
  ELSE
   BOX 91,140+14*(T-3),MM.HRES,14,0,,I 
  ENDIF
 NEXT T

END SUB


'-- SHOW DISPONIBLE OPTIONS AND CHANGE COLOR OF THE SELECTED ONE --
SUB GRAPHIC_OPTIONS_COLORS(OPT)

 FOR T=0 TO 5
  IF OPTC(T)>0 THEN
   IF T=OPT THEN OPTC(T)=2 ELSE OPTC(T)=1
  ENDIF
  SELECT CASE OPTC(T)
   CASE 2: I=RGB(255,255,255): II=RGB(255,255,0)
   CASE 1: I=RGB(127,127,127): II=RGB(0,0,0)
   CASE 0: I=RGB(127,0,0): II=RGB(0,0,0)
  END SELECT
  'MARK FONTS
  BOX 82,77+17*T,MM.HRES,17,0,,I
 NEXT T

END SUB


'-- SHOW DISPONIBLE OPTIONS AND CHANGE COLOR OF THE SELECTED ONE --
SUB HOW_TOUGH_COLORS(OPT)

 FOR T=0 TO 3
  IF OPTC(T)>0 THEN
   IF T=OPT THEN OPTC(T)=2 ELSE OPTC(T)=1
  ENDIF
  SELECT CASE OPTC(T)
   CASE 2: I=RGB(255,255,255)
   CASE 1: I=RGB(127,127,127)
   CASE 0: I=RGB(127,0,0)
  END SELECT
  BOX 71,80+13*T,MM.HRES,13,0,,I
 NEXT T

END SUB


'-- SHOW DISPONIBLE OPTIONS AND CHANGE COLOR OF THE SELECTED ONE --
SUB OPTION_COLORS(OPT)

 FOR T=0 TO 9
  IF OPTC(T)>0 THEN
   IF T=OPT THEN OPTC(T)=2 ELSE OPTC(T)=1
  ENDIF
  SELECT CASE OPTC(T)
   CASE 2: I=RGB(255,255,255)
   CASE 1: I=RGB(127,127,127)
   CASE 0: I=RGB(127,0,0)
  END SELECT
  BOX 0,59+13*T,MM.HRES,13,0,,I
 NEXT T

END SUB


'-- SHOW DISPONIBLE EPISODES AND CHANGE COLOR OF THE SELECTED ONE --
SUB EPISODE_COLORS(OPT)

 FOR T=0 TO 5
  IF OPTC(T)>0 THEN
   IF T=OPT THEN OPTC(T)=2 ELSE OPTC(T)=1
  ENDIF
  SELECT CASE OPTC(T)
   CASE 2: I=RGB(255,255,255)
   CASE 1: I=RGB(127,127,127)
   CASE 0: I=RGB(0,127,0)
  END SELECT
  BOX 94,23+26*T,MM.HRES,26,0,,I
 NEXT T

END SUB

